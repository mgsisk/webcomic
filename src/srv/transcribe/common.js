!function(){"use strict";!function e(){if("loading"===document.readyState)return document.addEventListener("DOMContentLoaded",e);function a(){for(var e=document.querySelectorAll(".webcomic-transcripts-toggle .webcomic-transcripts-toggler"),t=document.querySelectorAll(".webcomic-transcribe-cancel-link"),n=0;n<e.length;n++)e[n].dispatchEvent(new Event("change",{bubbles:!0}));for(var r=0;r<t.length;r++){var a=t[r].querySelector(".webcomic-transcribe-link").hash;t[r].style.display="none",window.location.href.match(/\/transcribe\/\d+\/#.+$/)&&window.location.hash===a&&(t[r].style.display=null)}}function i(e,t){var n=e.querySelector('[name="webcomic_transcript_id"]'),r=e.querySelector('[name="webcomic_transcript"]');n.value=t.id,r.value=t.content,function(e,t){if(!e)return;if(e.selectedIndex=-1,!t)return;for(var n=0;n<e.options.length;n++)-1!==t.indexOf(parseInt(e.options[n].value))&&(e.options[n].selected=!0)}(e.querySelector('[name="webcomic_transcript_language[]"]'),t.languages),function(e,t){if(!e)return;for(var n=e.querySelectorAll(".webcomic-transcribe-cancel-link"),r=0;r<n.length;r++)n[r].style.display="none",t&&(n[r].style.display=null)}(document.querySelector(t.hash),t.id),window.location.hash=t.hash,t.id&&r.focus()}document.addEventListener("change",function(e){var t=e.target,n=function(e){var t=e.classList.contains("webcomic-transcripts-toggler"),n=e;if("select"!==n.tagName.toLowerCase()||!t)return;for(;n.tagName&&!n.classList.contains("webcomic-transcripts-toggle");)n=n.parentNode;return n.tagName?n:void 0}(t);if(!n)return;var r=n.querySelectorAll(".webcomic_transcript.type-webcomic_transcript"),a=t.options[t.selectedIndex].className.match(/webcomic_transcript_\S+-\S+/);{if(!r)return;a&&(a=a[0])}for(var c=0;c<r.length;c++)r[c].style.display="none",r[c].classList.contains(a)&&(r[c].style.display=null)}),document.addEventListener("click",function(e){var t=e.target;for(;t.tagName&&"a"!==t.tagName.toLowerCase();)t=t.parentNode;if(!t.tagName||!t.classList.contains("webcomic-transcribe-link"))return;var n=t.href.match(/(?:\/transcribe\/(\d+)\/)?(#.+)$/),r=t.className.match(/webcomic-transcribe-parent-(\d+)/);if(!n||!r)return;var a=document.querySelectorAll("\n\t\t\t".concat(n[2]," form,\n\t\t\t").concat(n[2],' form [name="webcomic_transcript"],\n\t\t\t').concat(n[2],' form [name="webcomic_transcript_id"]\n\t\t\t'));if(3!==a.length)return;e.preventDefault(),function(t,n,r,e,a){if(i(n,{url:t.href,hash:r,id:0,content:"",languages:[]}),!e)return;var c=new FormData,o=new XMLHttpRequest;c.append("action","webcomic_transcribe"),c.append("post",parseInt(e)),c.append("parent",parseInt(a)),o.onreadystatechange=function(){if(4===o.readyState)if(o.responseText){var e=JSON.parse(o.responseText);e.url=t.href,e.hash=r,i(n,e)}else window.location.href=t.href},o.open("POST",webcomicCommonJS.ajaxurl),o.send(c)}(t,a[0],n[2],n[1],r[1])}),a(),new MutationObserver(function(e){for(var t=0;t<e.length;t++)if(e[t].addedNodes.length)for(var n=0;n<e[t].addedNodes.length;n++){var r=e[t].addedNodes[n];r&&r.tagName&&r.classList.contains("webcomic-dynamic")&&a()}}).observe(document.querySelector("body"),{childList:!0,subtree:!0})}()}();
